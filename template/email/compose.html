{% extends '../base.html' %}
{% load static %}
{% block content %}

<form class="card" method="post" enctype="multipart/form-data">{% csrf_token %}
  <div class="card-header bg-light">
    <h5 class="mb-0">Nuevo Mensaje</h5>
  </div>
  <div class="card-body p-0">
    <div class="border border-y-0 border-200">
      <select class="form-select js-choice border-0 rounded-0 outline-none px-card list_email" id="organizerMultiple" multiple="multiple" size="1" name="organizerMultiple" data-options='{"removeItemButton":true,"placeholder":true}'>
          <option value="">Selecciona un correo</option>
          <option>serg2o@carlos_del_aguila.com</option>
      </select>
    </div>
    <div class="border border-y-0 border-200">
      <input class="form-control border-0 rounded-0 outline-none px-card" id="email-subject" type="text" aria-describedby="email-subject" placeholder="Asunto" />
    </div>
    <div class="min-vh-50">
      <textarea class="tinymce d-none" name="content" placeholder="Mensaje"></textarea>
    </div>
    <div class="bg-light px-card py-3" id="file-list-container">
      <div class="d-inline-flex flex-column">
      </div>
    </div>
  </div>
  <div class="card-footer border-top border-200 d-flex flex-between-center">
    <div class="d-flex align-items-center">
      <button class="btn btn-primary btn-sm px-5 me-2 send_email" type="button">Send</button>
      <input class="d-none" id="email-attachment" type="file" multiple />
      <label class="me-2 btn btn-light btn-sm mb-0 cursor-pointer" for="email-attachment" data-bs-toggle="tooltip" data-bs-placement="top" title="Attach files">
        <span class="fas fa-paperclip fs-1" data-fa-transform="down-2"></span>
      </label>
    </div>
    <div class="d-flex align-items-center">
      <button class="btn btn-light btn-sm" type="button" data-bs-toggle="tooltip" data-bs-placement="top" title="Delete"> <span class="fas fa-trash"></span></button>
    </div>
  </div>
</form>

{% endblock %}
{% block script %}
  
  <script>
    preferens_columm  = 0
    $(document).ready(function(){
      $('#email-attachment').on('change', function() {
          var files = $(this)[0].files;
          var fileListContainer = $('#file-list-container .d-inline-flex');
          fileListContainer.empty();
          for (var i = 0; i < files.length; i++) {
              var file = files[i];
              var listItem = $(`<div class="border px-2 rounded-3 d-flex flex-between-center bg-white dark__bg-1000 my-1 fs--1">
                    <span class="fs-1 far fa-file"></span>
                    <span class="ms-2">${file.name} (${file.size} bytes)</span>
                    <a class="text-300 p-1 ms-6 delete-file" href="#!" data-bs-toggle="tooltip" data-bs-placement="right" title="Eliminar"><span class="fas fa-times"></span></a>
                </div>`);
              fileListContainer.append(listItem);
          }
          $('.delete-file').on('click', function() {
              var fileContainer = $(this).parent();
              fileContainer.remove();
          });
      });

    })
  </script>

{% endblock %}